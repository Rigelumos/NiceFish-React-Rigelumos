/*! For license information please see api-permission-edit.7512d890f44c8cc9b1f5.js.LICENSE.txt */
"use strict";(self.webpackChunknicefish_react=self.webpackChunknicefish_react||[]).push([[93],{66033:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var a=r(67294),n=r(89250),i=r(51814);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==l(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===l(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,i,l,o=[],s=!0,m=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;s=!1}else for(;!(s=(a=i.call(r)).done)&&(o.push(a.value),o.length!==t);s=!0);}catch(e){m=!0,n=e}finally{try{if(!s&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(m)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=new Array(t);r<t;r++)a[r]=e[r];return a}const f=function(e){var t=(0,n.s0)(),r=(0,n.UO)().apiPermissionId,l=c((0,a.useState)(!0),2),o=l[0],u=l[1],f=c((0,a.useState)({apiPermissionId:r,apiName:"",url:"",permission:"",remark:"",createTime:(new Date).toLocaleString(),updateTime:(new Date).toLocaleString()}),2),p=f[0],d=f[1],g=c((0,a.useState)({apiName:{valid:!0,ruleName:"",message:""},url:{valid:!0,ruleName:"",message:""},permission:{valid:!0,ruleName:"",message:""},remark:{valid:!0,ruleName:"",message:""}}),2),v=g[0],y=g[1],h={apiName:[{ruleName:"required",message:"请输入 API 名称",fn:function(e){return(e+"").trim().length>0}},{ruleName:"maxLength",message:"API 名称最多 32 位",fn:function(e){return(e+"").trim().length<=32}},{ruleName:"minLength",message:"API 名称最少 2 位",fn:function(e){return(e+"").trim().length>=2}}],url:[{ruleName:"maxLength",message:"URL 最多 1024 个字符",fn:function(e){return(e+"").trim().length<=1024}}],permission:[{ruleName:"required",message:"请输入权限通配符",fn:function(e){return(e+"").trim().length>0}},{ruleName:"maxLength",message:"权限通配符最多 64 位",fn:function(e){return(e+"").trim().length<=64}},{ruleName:"minLength",message:"权限通配符最少 1 位",fn:function(e){return(e+"").trim().length>=1}}],remark:[{ruleName:"maxLength",message:"备注最多 200 个字符",fn:function(e){return(e+"").trim().length<=200}},{ruleName:"minLength",message:"备注最少 2 个字符",fn:function(e){return(e+"").trim().length>=2}}]},b=function(e,t){if(h[e]){var r=s(s({},v),m({},e,{valid:!0,ruleName:"",message:""}));if(0===t.length){var a=!1;if(h[e].forEach((function(e){"required"===e.ruleName&&(a=!0)})),!a)return}h[e].forEach((function(a){a.fn(t)||(r[e].valid=!1,r[e].ruleName=a.ruleName,r[e].message=a.message)})),y(r)}},N=function(e,t){b(e,t),d(s(s({},p),{},m({},e,t)))};return(0,a.useEffect)((function(){"-1"!==r&&i.Z.getApiPermDetails(r).then((function(e){var t=e.data.data;d(s({},t))}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"加载用户信息失败"})}))}),[]),a.createElement("div",{className:"role-edit-container"},a.createElement("div",{className:"panel panel-default"},a.createElement("div",{className:"panel-heading"},a.createElement("h3",{className:"panel-title"},"创建/编辑后端接口权限")),a.createElement("div",{className:"panel-body"},a.createElement("form",{className:"form-horizontal",role:"form",noValidate:!0},a.createElement("div",{className:"form-group ".concat(v.apiName.valid?"":"has-error")},a.createElement("label",{className:"col-md-2 control-label"},"API 名称："),a.createElement("div",{className:"col-md-10"},a.createElement("input",{type:"text",className:"form-control",placeholder:"请输入 API 名称",name:"apiName",value:p.apiName,onChange:function(e){return N(e.target.name,e.target.value)},onBlur:function(e){return b(e.target.name,e.target.value)}}))),a.createElement("div",{className:"form-group ".concat(v.url.valid?"":"has-error")},a.createElement("label",{className:"col-md-2 control-label"},"API 接口 URL："),a.createElement("div",{className:"col-md-10"},a.createElement("input",{type:"text",className:"form-control",placeholder:"请输入 URL",name:"url",value:p.url||"",onChange:function(e){return N(e.target.name,e.target.value)},onBlur:function(e){return b(e.target.name,e.target.value)}}))),a.createElement("div",{className:"form-group ".concat(v.permission.valid?"":"has-error")},a.createElement("label",{className:"col-md-2 control-label"},"权限通配符："),a.createElement("div",{className:"col-md-10"},a.createElement("input",{type:"text",className:"form-control",placeholder:"请输入权限通配符",name:"permission",value:p.permission,onChange:function(e){return N(e.target.name,e.target.value)},onBlur:function(e){return b(e.target.name,e.target.value)}}),a.createElement("p",{className:"bg-danger"},"Apache Shiro 通配符权限文档： https://shiro.apache.org/permissions.html"))),a.createElement("div",{className:"form-group"},a.createElement("label",{className:"col-md-2 control-label"},"创建时间："),a.createElement("div",{className:"col-md-10"},p.createTime)),a.createElement("div",{className:"form-group"},a.createElement("label",{className:"col-md-2 control-label"},"更新时间："),a.createElement("div",{className:"col-md-10"},p.updateTime)),a.createElement("div",{className:"form-group ".concat(v.remark.valid?"":"has-error")},a.createElement("label",{className:"col-md-2 control-label"},"简介："),a.createElement("div",{className:"col-md-10"},a.createElement("textarea",{rows:"5",className:"form-control",placeholder:"简介",name:"remark",value:p.remark,onChange:function(e){return N(e.target.name,e.target.value)},onBlur:function(e){return b(e.target.name,e.target.value)}}))),a.createElement("div",{className:"form-group"},a.createElement("div",{className:"col-md-offset-2 col-md-10"},a.createElement("button",{type:"button",className:"btn btn-primary btn-margin-1rem",onClick:function(){!function(){var e=!0;for(var t in p)if(document.getElementsByName(t).length){var r=document.getElementsByName(t)[0].value;b(t,r)}for(var a in v)v[a].valid||(e=!1);u(e)}(),o?(delete p.createTime,delete p.updateTime,"-1"!==r?i.Z.updateApiPermission(p).then((function(e){e.data.success?(niceFishToast({severity:"success",summary:"Success",detail:"更新成功"}),window.history.back()):niceFishToast({severity:"error",summary:"Error",detail:"更新失败"})}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"更新失败"})})):i.Z.newApiPermission(p).then((function(e){e.data.success?(niceFishToast({severity:"success",summary:"Success",detail:"创建成功"}),window.history.back()):niceFishToast({severity:"error",summary:"Error",detail:"创建成功"})}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"创建失败"})}))):niceFishToast({severity:"error",summary:"Error",detail:"存在不合法的输入项，请检查"})}},"保存"),a.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){t(-1)}},"取消")))))))}},51814:(e,t,r)=>{r.d(t,{Z:()=>d});var a=r(24065),n=r(96486),i=r(90600),l=i.Z.dataURL.apiPermissionTableURL,o=i.Z.dataURL.apiPermissionListAll,s=i.Z.dataURL.apiPermissionListAllByRole,m=i.Z.dataURL.apiPermissionDetailURL,c=i.Z.dataURL.delApiPermissionURL,u=i.Z.dataURL.newApiPermissionURL,f=i.Z.dataURL.updateApiPermissionURL,p=i.Z.dataURL.apiRoleListURL;const d={getApiPermissionTable:function(e,t){var r=n.template(l)({page:e});return a.Z.post(r,{apiName:t})},getApiPermissionListAll:function(){var e=n.template(o)();return a.Z.post(e,{})},getApiPermissionListAllByRole:function(e){var t=n.template(s)();return a.Z.post(t,e)},getRolesByApiId:function(e){var t=n.template(p)({id:e});return a.Z.get(t)},getApiPermDetails:function(e){var t=n.template(m)({id:e});return a.Z.get(t)},deleteByApiId:function(e){var t=n.template(c)({id:e});return a.Z.delete(t)},newApiPermission:function(e){return a.Z.post(u,e)},updateApiPermission:function(e){return a.Z.post(f,e)}}}}]);