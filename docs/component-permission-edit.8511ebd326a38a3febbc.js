/*! For license information please see component-permission-edit.8511ebd326a38a3febbc.js.LICENSE.txt */
"use strict";(self.webpackChunknicefish_react=self.webpackChunknicefish_react||[]).push([[846],{7549:(e,t,r)=>{r.r(t),r.d(t,{default:()=>f});var n=r(67294),a=r(89250),l=r(56168);function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==o(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===o(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,l,o,m=[],c=!0,i=!1;try{if(l=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=l.call(r)).done)&&(m.push(n.value),m.length!==t);c=!0);}catch(e){i=!0,a=e}finally{try{if(!c&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(i)throw a}}return m}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const f=function(e){var t=(0,a.s0)(),r=(0,a.UO)(),o=r.compPermId,m=r.pId,u=s((0,n.useState)(!0),2),f=u[0],d=u[1],p=s((0,n.useState)({parentEntity:null,compPermId:o,componentName:"",icon:"",url:"",displayOrder:1,permission:"",visiable:1,remark:""}),2),g=p[0],v=p[1],y=s((0,n.useState)({componentName:{valid:!0,ruleName:"",message:""},icon:{valid:!0,ruleName:"",message:""},url:{valid:!0,ruleName:"",message:""},displayOrder:{valid:!0,ruleName:"",message:""},permission:{valid:!0,ruleName:"",message:""},visiable:{valid:!0,ruleName:"",message:""},remark:{valid:!0,ruleName:"",message:""}}),2),h=y[0],b=y[1],N={componentName:[{ruleName:"required",message:"请输入 API 名称",fn:function(e){return(e+"").trim().length>0}},{ruleName:"maxLength",message:"API 名称最多 32 位",fn:function(e){return(e+"").trim().length<=32}},{ruleName:"minLength",message:"API 名称最少 2 位",fn:function(e){return(e+"").trim().length>=2}}],icon:[{ruleName:"maxLength",message:"URL 最多 1024 个字符",fn:function(e){return(e+"").trim().length<=1024}}],url:[{ruleName:"maxLength",message:"URL 最多 1024 个字符",fn:function(e){return(e+"").trim().length<=1024}}],displayOrder:[{ruleName:"required",message:"请输入显示顺序",fn:function(e){return(e+"").trim().length>0}},{ruleName:"maxLength",message:"显示顺序最多 4 位",fn:function(e){return(e+"").trim().length<=4}},{ruleName:"minLength",message:"显示顺序最少 1 位",fn:function(e){return(e+"").trim().length>=1}}],permission:[{ruleName:"required",message:"请输入权限通配符",fn:function(e){return(e+"").trim().length>0}},{ruleName:"maxLength",message:"权限通配符最多 64 位",fn:function(e){return(e+"").trim().length<=64}},{ruleName:"minLength",message:"权限通配符最少 1 位",fn:function(e){return(e+"").trim().length>=1}}],remark:[{ruleName:"maxLength",message:"备注最多 200 个字符",fn:function(e){return(e+"").trim().length<=200}},{ruleName:"minLength",message:"备注最少 2 个字符",fn:function(e){return(e+"").trim().length>=2}}]},E=function(e,t){if(N[e]){var r=c(c({},h),i({},e,{valid:!0,ruleName:"",message:""}));if(0===t.length){var n=!1;if(N[e].forEach((function(e){"required"===e.ruleName&&(n=!0)})),!n)return}N[e].forEach((function(n){n.fn(t)||(r[e].valid=!1,r[e].ruleName=n.ruleName,r[e].message=n.message)})),b(r)}},P=function(e,t){E(e,t),v(c(c({},g),{},i({},e,t)))};return(0,n.useEffect)((function(){"-1"!==o&&l.Z.getCompPermDetails(o).then((function(e){var t=e.data;v(c({},t))}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"加载用户信息失败"})})),"-1"!==m&&l.Z.getCompPermDetails(m).then((function(e){var t=e.data;v(c(c({},g),{},{parentEntity:t}))}))}),[]),n.createElement("div",{className:"role-edit-container"},n.createElement("div",{className:"panel panel-default"},n.createElement("div",{className:"panel-heading"},n.createElement("h3",{className:"panel-title"},"创建/编辑前端组件权限")),n.createElement("div",{className:"panel-body"},n.createElement("form",{className:"form-horizontal",role:"form",noValidate:!0},n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"父层组件："),n.createElement("div",{className:"col-md-10"},g.parentEntity?n.createElement("span",{className:"label label-success form-control"},g.parentEntity.componentName):n.createElement("span",{className:"label label-danger form-control"},"无"))),n.createElement("div",{className:" form-group"},n.createElement("label",{className:"col-md-2 control-label"},"组件名称："),n.createElement("div",{className:"col-md-10"},n.createElement("input",{type:"text",className:"form-control",placeholder:"请输入组件名称",name:"componentName",value:g.componentName,onChange:function(e){return P(e.target.name,e.target.value)},onBlur:function(e){return E(e.target.name,e.target.value)}}))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"组件图标："),n.createElement("div",{className:"col-md-10"},n.createElement("input",{type:"text",className:"form-control",placeholder:"请输入图标 URL",name:"icon",value:g.icon||"",onChange:function(e){return P(e.target.name,e.target.value)},onBlur:function(e){return E(e.target.name,e.target.value)}}))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"组件 URL："),n.createElement("div",{className:"col-md-10"},n.createElement("input",{type:"text",className:"form-control",placeholder:"请输入 URL",name:"url",value:g.url||"",onChange:function(e){return P(e.target.name,e.target.value)},onBlur:function(e){return E(e.target.name,e.target.value)}}))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"显示顺序："),n.createElement("div",{className:"col-md-10"},n.createElement("input",{type:"number",className:"form-control",placeholder:"请输入显示顺序",name:"displayOrder",value:g.displayOrder,onChange:function(e){return P(e.target.name,e.target.value)},onBlur:function(e){return E(e.target.name,e.target.value)}}))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"权限通配符："),n.createElement("div",{className:"col-md-10"},n.createElement("input",{type:"text",className:"form-control",placeholder:"请输入权限通配符",name:"permission",value:g.permission,onChange:function(e){return P(e.target.name,e.target.value)},onBlur:function(e){return E(e.target.name,e.target.value)}}),n.createElement("p",{className:"bg-danger"},"Apache Shiro 通配符权限文档： https://shiro.apache.org/permissions.html"))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"是否启用："),n.createElement("div",{className:"col-md-10"},n.createElement("div",{className:"checkbox"},n.createElement("label",null,n.createElement("input",{type:"checkbox",name:"visiable",checked:1===g.visiable,onChange:function(e){var t=e.target.checked?1:0;P(e.target.name,t)}}))))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"col-md-2 control-label"},"备注："),n.createElement("div",{className:"col-md-10"},n.createElement("textarea",{rows:"5",type:"text",className:"form-control",placeholder:"备注",name:"remark",value:g.remark,onChange:function(e){return P(e.target.name,e.target.value)},onBlur:function(e){return E(e.target.name,e.target.value)}}))),n.createElement("div",{className:"form-group"},n.createElement("div",{className:"col-md-offset-2 col-md-10"},n.createElement("button",{type:"button",className:"btn btn-primary btn-margin-1rem",onClick:function(e){e.preventDefault(),function(){var e=!0;for(var t in g)if(document.getElementsByName(t).length){var r=document.getElementsByName(t)[0].value;E(t,r)}for(var n in h)h[n].valid||(e=!1);d(e)}(),f?("-1"!==m&&(g.parentEntity={compPermId:m}),delete g.roleEntities,delete g.children,"-1"!==o?l.Z.updateCompPerm(g).then((function(e){e.data.success?(niceFishToast({severity:"success",summary:"Success",detail:"更新成功"}),window.history.back()):niceFishToast({severity:"error",summary:"Error",detail:"更新失败"})}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"更新失败"})})):l.Z.newCompPerm(g).then((function(e){e.data.success?(niceFishToast({severity:"success",summary:"Success",detail:"创建成功"}),window.history.back()):niceFishToast({severity:"error",summary:"Error",detail:"创建成功"})}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"创建失败"})}))):niceFishToast({severity:"error",summary:"Error",detail:"存在不合法的输入项，请检查"})}},"保存"),n.createElement("button",{type:"button",className:"btn btn-default",onClick:function(){t(-1)}},"取消")))))))}},56168:(e,t,r)=>{r.d(t,{Z:()=>d});var n=r(24065),a=r(96486),l=r(90600),o=l.Z.dataURL.compPermListURL,m=l.Z.dataURL.compPermDetailURL,c=l.Z.dataURL.compPermissionListAllByRole,i=l.Z.dataURL.delCompPermURL,s=l.Z.dataURL.newCompPermURL,u=l.Z.dataURL.updateCompPermURL,f=l.Z.dataURL.compRoleListURL;const d={getCompPermTable:function(e,t){var r=a.template(o)({page:e});return n.Z.post(r,{componentName:t})},getCompPermListByRoleId:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=a.template(c)();return n.Z.post(t,e)},getRolesByCompId:function(e){var t=a.template(f)({id:e});return n.Z.get(t)},getCompPermDetails:function(e){var t=a.template(m)({id:e});return n.Z.get(t)},deleteByCompPermId:function(e){var t=a.template(i)({id:e});return n.Z.delete(t)},newCompPerm:function(e){return n.Z.post(s,e)},updateCompPerm:function(e){return n.Z.post(u,e)}}}}]);