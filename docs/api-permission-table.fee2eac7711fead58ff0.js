/*! For license information please see api-permission-table.fee2eac7711fead58ff0.js.LICENSE.txt */
"use strict";(self.webpackChunknicefish_react=self.webpackChunknicefish_react||[]).push([[249],{38060:(e,t,n)=>{n.r(t),n.d(t,{default:()=>p});var a=n(67294),r=n(59908),i=n(58650),s=n(99403),l=n(89250),o=n(88843),c=n(51814);function m(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,i,s,l=[],o=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(a=i.call(n)).done)&&(l.push(a.value),l.length!==t);o=!0);}catch(e){c=!0,r=e}finally{try{if(!o&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}const p=function(e){var t=(0,l.s0)(),n=m((0,a.useState)([]),2),u=n[0],p=n[1],d=m((0,a.useState)(0),2),f=d[0],h=d[1],v=m((0,a.useState)(10),2),y=v[0],E=v[1],b=m((0,a.useState)(1),2),g=b[0],A=b[1],N=m((0,a.useState)(0),2),R=N[0],L=N[1],P=function(){c.Z.getApiPermissionTable(g,"").then((function(e){var t,n=e.data;L(n.totalElements),n=(null===(t=n)||void 0===t?void 0:t.content)||[],p(n)}))};return(0,a.useEffect)(P,[]),a.createElement("div",{className:"api-permission-table-container"},a.createElement("form",{className:"form-vertical",role:"form"},a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-11"},a.createElement("div",{className:"input-group"},a.createElement("input",{name:"searchStr",className:"form-control",type:"text",placeholder:"API 名称或者权限字符串"}),a.createElement("span",{className:"input-group-btn"},a.createElement("button",{className:"btn btn-default",type:"button"},a.createElement("i",{className:"fa fa-search","aria-hidden":"true"}))))),a.createElement("div",{className:"col-md-1"},a.createElement("div",{className:"input-group pull-right"},a.createElement("button",{className:"btn btn-primary",type:"button",onClick:function(){t("/manage/permission/api-permission-edit/-1")}},a.createElement("i",{className:"pi pi-plus","aria-hidden":"true"})))))),a.createElement("div",{className:"row"},a.createElement("div",{className:"col-md-12"},a.createElement("div",{className:"permission-item-container"},a.createElement(r.w,{showGridlines:!0,stripedRows:!0,tableStyle:{width:"100%"},value:u,rows:y,first:f,paginator:{totalRecords:R,onPageChange:function(e){h(e.first),E(e.rows),A(e.page+1)}}},a.createElement(i.s,{field:"apiName",header:"API 名称"}),a.createElement(i.s,{field:"url",header:"URL"}),a.createElement(i.s,{field:"permission",header:"权限通配符"}),a.createElement(i.s,{field:"remark",header:"备注",style:{maxWidth:"120px"}}),a.createElement(i.s,{field:"roleEntities",body:function(e){var t;return null==e||null===(t=e.roleEntities)||void 0===t?void 0:t.map((function(e){return a.createElement("h5",{key:e.roleId},a.createElement("span",{className:"label label-success"},e.roleName))}))},header:"已关联角色"}),a.createElement(i.s,{field:"",header:"操作",body:function(e){return a.createElement(a.Fragment,null,a.createElement(s.z,{icon:"pi pi-pencil",className:"p-button-success",onClick:function(){t("/manage/permission/api-permission-edit/"+e.apiPermissionId)}}),"  ",a.createElement(s.z,{icon:"pi pi-trash",className:"p-button-danger",onClick:function(){var t;t=e,(0,o.V)({message:"确定要删除吗？",header:"确认",icon:"pi pi-exclamation-triangle",accept:function(){c.Z.deleteByApiId(t.apiPermissionId).then((function(e){niceFishToast({severity:"success",summary:"Success",detail:"删除成功"})}),(function(e){niceFishToast({severity:"error",summary:"Error",detail:"删除失败"})})).finally(P)},reject:function(){console.log("reject")}})}}))}}))))))}},51814:(e,t,n)=>{n.d(t,{Z:()=>f});var a=n(24065),r=n(96486),i=n(90600),s=i.Z.dataURL.apiPermissionTableURL,l=i.Z.dataURL.apiPermissionListAll,o=i.Z.dataURL.apiPermissionListAllByRole,c=i.Z.dataURL.apiPermissionDetailURL,m=i.Z.dataURL.delApiPermissionURL,u=i.Z.dataURL.newApiPermissionURL,p=i.Z.dataURL.updateApiPermissionURL,d=i.Z.dataURL.apiRoleListURL;const f={getApiPermissionTable:function(e,t){var n=r.template(s)({page:e});return a.Z.post(n,{apiName:t})},getApiPermissionListAll:function(){var e=r.template(l)();return a.Z.post(e,{})},getApiPermissionListAllByRole:function(e){var t=r.template(o)();return a.Z.post(t,e)},getRolesByApiId:function(e){var t=r.template(d)({id:e});return a.Z.get(t)},getApiPermDetails:function(e){var t=r.template(c)({id:e});return a.Z.get(t)},deleteByApiId:function(e){var t=r.template(m)({id:e});return a.Z.delete(t)},newApiPermission:function(e){return a.Z.post(u,e)},updateApiPermission:function(e){return a.Z.post(p,e)}}}}]);